===== SLURM INFO =====
JOBID: 22754806
NODELIST: fc10411
CPUS_PER_TASK: 12
GPUS_ON_NODE: 1
SUBMIT_DIR: /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8
======================
===== SCONTROL (Req/Alloc) =====
   ReqNodeList=(null) ExcNodeList=(null)
   NodeList=fc10411
   ReqTRES=cpu=12,mem=48G,node=1,billing=12200,gres/gpu=1,gres/gpu:h100=1
   AllocTRES=cpu=12,mem=48G,node=1,billing=12200,gres/gpu=1,gres/gpu:h100=1
================================
The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) CCconfig        6)  ucx/1.14.1         11) flexiblas/3.3.1
  2) gentoo/2023     7)  libfabric/1.18.0   12) aocl-blas/5.1
  3) gcccore/.12.3   8)  pmix/4.2.4         13) aocl-lapack/5.1
  4) gcc/12.3        9)  ucc/1.2.0          14) StdEnv/2023
  5) hwloc/2.9.1     10) openmpi/4.1.5
===== ENV SETUP =====
PWD: /project/def-nahee/kbas/pone_offline
Activating venv: /project/def-nahee/kbas/pone_offline/graphnet_env/bin/activate
Python: /project/6061446/kbas/pone_offline/graphnet_env/bin/python3
sys.executable = /project/6061446/kbas/pone_offline/graphnet_env/bin/python3
torch: 2.6.0
cuda available: True
cuda device: NVIDIA H100 80GB HBM3
===== GPU INFO =====
Thu Feb 12 17:13:31 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 580.65.06              Driver Version: 580.65.06      CUDA Version: 13.0     |
+-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100 80GB HBM3          On  |   00000000:46:00.0 Off |                    0 |
| N/A   22C    P0             66W /  700W |       0MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
====================
===== RUN =====

========== CONFIG ==========
seed: 20260202
train_path: /project/def-nahee/kbas/POM_Response_Parquet/merged/train_reindexed
val_path: /project/def-nahee/kbas/POM_Response_Parquet/merged/val_reindexed
test_path: /project/def-nahee/kbas/POM_Response_Parquet/merged/test_reindexed
pulsemaps: features
truth_table: truth
features: ('pmt_x', 'pmt_y', 'pmt_z', 'dom_time', 'charge')
truth_all: ('azimuth', 'zenith', 'energy')
batch_size: 256
num_workers: 8
multiprocessing_context: spawn
persistent_workers: True
pin_memory: True
max_epochs: 30
early_stopping_patience: 5
base_lr: 1e-05
peak_lr: 0.001
accumulate_grad_batches: 4
nb_neighbours: 8
global_pooling_schemes: ('min', 'max', 'mean', 'sum')
add_global_variables_after_pooling: True
add_norm_layer: False
skip_readout: False
transform_support: (10.0, 100000000.0)
save_dir: /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8
metrics_name: metrics.csv
test_csv_name: test_predictions.csv
resources_and_time_csv_name: resources_and_time.csv
============================

[Data] Building data_representation (KNNGraph + robust scaling)
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-12 17:17:09 - PONE.__init__ - Writing log to [1mlogs/graphnet_20260212-171709.log[0m
[Data] Creating ParquetDataset(s)
[Data] Creating DataLoader(s)
[Data] len(train_loader) = 1256 batches/epoch (drop_last=True)
[Data] len(val_loader)   = 156 batches/epoch
[Data] len(test_loader)  = 162 batches
[Sanity] azimuth range: 0.048..6.270
[Sanity] zenith  range: 0.083..3.016
[Sanity] energy  range: 1.007e+02..8.743e+06
[rank: 0] Seed set to 20260202

[Run=energy] torch.cuda.is_available() = True
[Run=energy] GPU = NVIDIA H100 80GB HBM3
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
/project/6061446/kbas/pone_offline/graphnet_env/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/logger_connector/logger_connector.py:76: Starting from v1.9.0, `tensorboardX` has been removed as a dependency of the `pytorch_lightning` package, due to potential conflicts with other packages in the ML ecosystem. For this reason, `logger=True` will use `CSVLogger` as the default logger, unless the `tensorboard` or `tensorboardX` packages are found. Please `pip install lightning[extra]` or one of them to enable TensorBoard support by default
You are using a CUDA device ('NVIDIA H100 80GB HBM3') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                 | Type       | Params | Mode 
------------------------------------------------------------
0 | _tasks               | ModuleList | 129    | train
1 | _data_representation | KNNGraph   | 0      | train
2 | backbone             | DynEdge    | 1.4 M  | train
------------------------------------------------------------
1.4 M     Trainable params
0         Non-trainable params
1.4 M     Total params
5.501     Total estimated model params size (MB)
36        Modules in train mode
0         Modules in eval mode
SLURM auto-requeueing enabled. Setting signal handlers.
Metric val_loss improved. New best score: 0.142 | epoch: 0
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-12 17:39:01 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth[0m
Metric val_loss improved by 0.020 >= min_delta = 0.0. New best score: 0.121 | epoch: 1
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-12 17:58:11 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth[0m
Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: 0.109 | epoch: 2
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-12 18:17:17 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth[0m
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.109 | epoch: 3
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-12 18:36:32 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth[0m
Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: 0.101 | epoch: 4
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-12 18:55:45 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth[0m
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.100 | epoch: 6
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-12 19:34:31 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth[0m
Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: 0.095 | epoch: 8
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-12 20:13:16 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth[0m
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.094 | epoch: 9
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-12 20:32:14 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth[0m
Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: 0.092 | epoch: 10
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-12 20:51:20 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth[0m
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.091 | epoch: 11
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-12 21:10:27 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth[0m
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.091 | epoch: 13
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-12 21:49:36 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth[0m
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: 0.090 | epoch: 15
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-12 22:28:25 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth[0m
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.090 | epoch: 16
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-12 22:47:51 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth[0m
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.090 | epoch: 19
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-12 23:45:52 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth[0m
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.090 | epoch: 20
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 00:04:49 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth[0m
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: 0.090 | epoch: 24
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 01:22:13 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth[0m
Monitored metric val_loss did not improve in the last 5 records. Best score: 0.090. Signaling Trainer to stop.
`Trainer.fit` stopped: `max_epochs=30` reached.
[Resources] Wrote /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/resources_and_time.csv | last_epoch=29 | total=582.99 min
[Run=energy] best_model: /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth
[Run=energy] config:     /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/config.yml
[Run=energy] metrics:    /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/metrics.csv
[Test=energy] Loaded best weights: /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/best_model.pth
[Test=energy] batch 0/162 | resid mean=-0.033
[Test=energy] batch 20/162 | resid mean=-0.058
[Test=energy] batch 40/162 | resid mean=-0.069
[Test=energy] batch 60/162 | resid mean=-0.043
[Test=energy] batch 80/162 | resid mean=-0.022
[Test=energy] batch 100/162 | resid mean=-0.007
[Test=energy] batch 120/162 | resid mean=0.003
[Test=energy] batch 140/162 | resid mean=-0.021
[Test=energy] batch 160/162 | resid mean=-0.011
[Test=energy] Wrote: /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/energy/test_predictions.csv | rows=41311
[Test=energy] residual_log10: p16=-0.3470, p50=0.0275, p84=0.3172, W=0.3321
[rank: 0] Seed set to 20260202

[Run=azimuth] torch.cuda.is_available() = True
[Run=azimuth] GPU = NVIDIA H100 80GB HBM3
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                 | Type       | Params | Mode 
------------------------------------------------------------
0 | _tasks               | ModuleList | 258    | train
1 | _data_representation | KNNGraph   | 0      | eval 
2 | backbone             | DynEdge    | 1.4 M  | train
------------------------------------------------------------
1.4 M     Trainable params
0         Non-trainable params
1.4 M     Total params
5.502     Total estimated model params size (MB)
32        Modules in train mode
4         Modules in eval mode
SLURM auto-requeueing enabled. Setting signal handlers.
/project/6061446/kbas/pone_offline/graphnet_env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py:527: Found 4 module(s) in eval mode at the start of training. This may lead to unexpected behavior during training. If this is intentional, you can ignore this warning.
Metric val_loss improved. New best score: 0.051 | epoch: 0
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 03:47:25 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.283 >= min_delta = 0.0. New best score: -0.232 | epoch: 1
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 04:07:17 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.112 >= min_delta = 0.0. New best score: -0.344 | epoch: 2
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 04:27:04 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.025 >= min_delta = 0.0. New best score: -0.369 | epoch: 3
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 04:46:58 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.063 >= min_delta = 0.0. New best score: -0.432 | epoch: 4
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 05:06:44 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: -0.444 | epoch: 5
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 05:26:30 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.019 >= min_delta = 0.0. New best score: -0.463 | epoch: 6
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 05:46:30 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.037 >= min_delta = 0.0. New best score: -0.500 | epoch: 7
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 06:06:17 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.011 >= min_delta = 0.0. New best score: -0.511 | epoch: 8
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 06:26:19 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: -0.526 | epoch: 9
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 06:46:20 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.016 >= min_delta = 0.0. New best score: -0.542 | epoch: 11
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 07:26:04 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: -0.550 | epoch: 12
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 07:45:55 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: -0.551 | epoch: 14
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 08:25:14 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: -0.565 | epoch: 15
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 08:44:45 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: -0.580 | epoch: 17
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 09:23:56 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: -0.585 | epoch: 21
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 10:42:48 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: -0.590 | epoch: 22
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 11:02:21 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: -0.591 | epoch: 25
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 12:01:13 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth[0m
`Trainer.fit` stopped: `max_epochs=30` reached.
[Resources] Wrote /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/resources_and_time.csv | last_epoch=29 | total=595.31 min
[Run=azimuth] best_model: /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth
[Run=azimuth] config:     /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/config.yml
[Run=azimuth] metrics:    /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/metrics.csv
[Test=azimuth] Loaded best weights: /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/best_model.pth
[Test=azimuth] batch 0/162 | median_abs_error_deg=3.338
[Test=azimuth] batch 50/162 | median_abs_error_deg=2.930
[Test=azimuth] batch 100/162 | median_abs_error_deg=2.528
[Test=azimuth] batch 150/162 | median_abs_error_deg=2.958
[Test=azimuth] Wrote: /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/azimuth/test_predictions.csv | rows=41311
[Test=azimuth] abs_error_deg: p16=0.698, p50=2.845, p84=13.613 | kappa_mean=71.582
[rank: 0] Seed set to 20260202

[Run=zenith] torch.cuda.is_available() = True
[Run=zenith] GPU = NVIDIA H100 80GB HBM3
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name                 | Type       | Params | Mode 
------------------------------------------------------------
0 | _tasks               | ModuleList | 258    | train
1 | _data_representation | KNNGraph   | 0      | eval 
2 | backbone             | DynEdge    | 1.4 M  | train
------------------------------------------------------------
1.4 M     Trainable params
0         Non-trainable params
1.4 M     Total params
5.502     Total estimated model params size (MB)
32        Modules in train mode
4         Modules in eval mode
SLURM auto-requeueing enabled. Setting signal handlers.
/project/6061446/kbas/pone_offline/graphnet_env/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py:527: Found 4 module(s) in eval mode at the start of training. This may lead to unexpected behavior during training. If this is intentional, you can ignore this warning.
Metric val_loss improved. New best score: 0.247 | epoch: 0
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 14:04:19 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.151 >= min_delta = 0.0. New best score: 0.095 | epoch: 2
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 14:43:52 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.657 >= min_delta = 0.0. New best score: -0.562 | epoch: 3
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 15:04:00 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.134 >= min_delta = 0.0. New best score: -0.696 | epoch: 4
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 15:23:50 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.084 >= min_delta = 0.0. New best score: -0.779 | epoch: 5
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 15:43:37 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.015 >= min_delta = 0.0. New best score: -0.794 | epoch: 6
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 16:03:26 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: -0.802 | epoch: 7
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 16:23:06 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.039 >= min_delta = 0.0. New best score: -0.841 | epoch: 8
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 16:42:36 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.014 >= min_delta = 0.0. New best score: -0.855 | epoch: 10
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 17:21:31 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.002 >= min_delta = 0.0. New best score: -0.857 | epoch: 11
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 17:41:00 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.029 >= min_delta = 0.0. New best score: -0.886 | epoch: 12
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 18:00:25 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.008 >= min_delta = 0.0. New best score: -0.894 | epoch: 13
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 18:20:01 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.012 >= min_delta = 0.0. New best score: -0.906 | epoch: 16
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 19:18:51 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.005 >= min_delta = 0.0. New best score: -0.911 | epoch: 17
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 19:38:23 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.013 >= min_delta = 0.0. New best score: -0.924 | epoch: 18
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 19:57:55 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: -0.925 | epoch: 19
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 20:17:15 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.001 >= min_delta = 0.0. New best score: -0.927 | epoch: 20
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 20:36:48 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.003 >= min_delta = 0.0. New best score: -0.930 | epoch: 21
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 20:56:16 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: -0.930 | epoch: 24
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 21:54:36 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
Metric val_loss improved by 0.000 >= min_delta = 0.0. New best score: -0.930 | epoch: 25
[1;34mgraphnet[0m [MainProcess] [32mINFO    [0m 2026-02-13 22:14:05 - StandardModel.save_state_dict - Model state_dict saved to /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth[0m
`Trainer.fit` stopped: `max_epochs=30` reached.
[Resources] Wrote /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/resources_and_time.csv | last_epoch=29 | total=594.29 min
[Run=zenith] best_model: /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth
[Run=zenith] config:     /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/config.yml
[Run=zenith] metrics:    /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/metrics.csv
[Test=zenith] Loaded best weights: /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/best_model.pth
[Test=zenith] batch 0/162 | median_abs_error_deg=2.102
[Test=zenith] batch 50/162 | median_abs_error_deg=1.821
[Test=zenith] batch 100/162 | median_abs_error_deg=1.998
[Test=zenith] batch 150/162 | median_abs_error_deg=1.686
[Test=zenith] Wrote: /project/6061446/kbas/Graphnet-Applications/Training/Combined_EventPulseSeries_nonoise/initiative8/zenith/test_predictions.csv | rows=41311
[Test=zenith] abs_error_deg: p16=0.464, p50=1.820, p84=7.328 | kappa_mean=83.887
===== DONE =====
